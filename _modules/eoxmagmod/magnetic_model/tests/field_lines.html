<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>eoxmagmod.magnetic_model.tests.field_lines &mdash; MagneticModel  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> MagneticModel
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/modules.html">Module Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">MagneticModel</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
      <li>eoxmagmod.magnetic_model.tests.field_lines</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for eoxmagmod.magnetic_model.tests.field_lines</h1><div class="highlight"><pre>
<span></span><span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1">#  Field line tracing tests</span>
<span class="c1">#</span>
<span class="c1"># Author: Martin Paces &lt;martin.paces@eox.at&gt;</span>
<span class="c1">#</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Copyright (C) 2018 EOX IT Services GmbH</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in all</span>
<span class="c1"># copies of this Software or works derived from this Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="c1"># THE SOFTWARE.</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">main</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_allclose</span>
<span class="kn">from</span> <span class="nn">eoxmagmod</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">decimal_year_to_mjd2000</span><span class="p">,</span>
    <span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span> <span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">,</span> <span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">,</span> <span class="n">convert</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">eoxmagmod.data</span> <span class="kn">import</span> <span class="n">IGRF12</span>
<span class="kn">from</span> <span class="nn">eoxmagmod.magnetic_model.loader_shc</span> <span class="kn">import</span> <span class="n">load_model_shc</span>
<span class="kn">from</span> <span class="nn">eoxmagmod.magnetic_model.field_lines</span> <span class="kn">import</span> <span class="n">trace_field_line</span>


<span class="n">START_POINT</span> <span class="o">=</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">FIELD_LINE_POINTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">35.368274996757364</span><span class="p">,</span> <span class="mf">39.700301184417704</span><span class="p">,</span> <span class="o">-</span><span class="mf">95.91876095112734</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">35.01448795969475</span><span class="p">,</span> <span class="mf">39.38936383790091</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.343611242758463</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">34.65414363332517</span><span class="p">,</span> <span class="mf">39.09143885427224</span><span class="p">,</span> <span class="mf">80.46632581641443</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">34.287149154580035</span><span class="p">,</span> <span class="mf">38.80570910775888</span><span class="p">,</span> <span class="mf">170.48385743954177</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">33.91340521112774</span><span class="p">,</span> <span class="mf">38.53140370245006</span><span class="p">,</span> <span class="mf">261.6822730851895</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">33.53280735294822</span><span class="p">,</span> <span class="mf">38.267798475813166</span><span class="p">,</span> <span class="mf">354.0351700406412</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">33.1452470118385</span><span class="p">,</span> <span class="mf">38.01421548215414</span><span class="p">,</span> <span class="mf">447.51625673497267</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">32.750612275176636</span><span class="p">,</span> <span class="mf">37.7700217364484</span><span class="p">,</span> <span class="mf">542.0991419682955</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">32.348788456873976</span><span class="p">,</span> <span class="mf">37.53462744515785</span><span class="p">,</span> <span class="mf">637.7571157694631</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">31.939658503966836</span><span class="p">,</span> <span class="mf">37.30748390300443</span><span class="p">,</span> <span class="mf">734.4629256736445</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">31.52310327245107</span><span class="p">,</span> <span class="mf">37.08808119402684</span><span class="p">,</span> <span class="mf">832.188550741245</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">31.09900170120541</span><span class="p">,</span> <span class="mf">36.87594580155175</span><span class="p">,</span> <span class="mf">930.9049745552805</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">30.667230908453966</span><span class="p">,</span> <span class="mf">36.67063820441013</span><span class="p">,</span> <span class="mf">1030.5819576474994</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">30.227666231323482</span><span class="p">,</span> <span class="mf">36.471750515034486</span><span class="p">,</span> <span class="mf">1131.1878092395004</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">29.78018122571178</span><span class="p">,</span> <span class="mf">36.27890419812684</span><span class="p">,</span> <span class="mf">1232.689157814918</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">29.324647640898338</span><span class="p">,</span> <span class="mf">36.091747895561944</span><span class="p">,</span> <span class="mf">1335.0507197839638</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">28.860935381065538</span><span class="p">,</span> <span class="mf">35.909955373337105</span><span class="p">,</span> <span class="mf">1438.2350653505048</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">28.38891246411117</span><span class="p">,</span> <span class="mf">35.73322359905164</span><span class="p">,</span> <span class="mf">1542.2023806207974</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">27.90844498676852</span><span class="p">,</span> <span class="mf">35.561270953051796</span><span class="p">,</span> <span class="mf">1646.9102249578998</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">27.41939710405605</span><span class="p">,</span> <span class="mf">35.39383557256511</span><span class="p">,</span> <span class="mf">1752.3132826146998</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">26.92163103040731</span><span class="p">,</span> <span class="mf">35.230673825512135</span><span class="p">,</span> <span class="mf">1858.3631077202954</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">26.415007069440566</span><span class="p">,</span> <span class="mf">35.07155890893757</span><span class="p">,</span> <span class="mf">1965.007861777713</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">25.89938367917968</span><span class="p">,</span> <span class="mf">34.91627956592198</span><span class="p">,</span> <span class="mf">2072.192042940848</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">25.37461757960237</span><span class="p">,</span> <span class="mf">34.764638914245836</span><span class="p">,</span> <span class="mf">2179.856206466061</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">24.84056390964275</span><span class="p">,</span> <span class="mf">34.61645337984352</span><span class="p">,</span> <span class="mf">2287.936675905992</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">24.29707644118915</span><span class="p">,</span> <span class="mf">34.47155172810397</span><span class="p">,</span> <span class="mf">2396.36524481469</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">23.744007858176246</span><span class="p">,</span> <span class="mf">34.32977418626811</span><span class="p">,</span> <span class="mf">2505.0688689659514</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">23.181210109552595</span><span class="p">,</span> <span class="mf">34.19097165048101</span><span class="p">,</span> <span class="mf">2613.969349395268</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">22.60853484569234</span><span class="p">,</span> <span class="mf">34.055004971435714</span><span class="p">,</span> <span class="mf">2722.9830069089776</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">22.0258339486906</span><span class="p">,</span> <span class="mf">33.92174431296016</span><span class="p">,</span> <span class="mf">2832.0203491323055</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">21.43296016791004</span><span class="p">,</span> <span class="mf">33.7910685783249</span><span class="p">,</span> <span class="mf">2940.9857316681073</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">20.829767873099758</span><span class="p">,</span> <span class="mf">33.66286489946678</span><span class="p">,</span> <span class="mf">3049.777015521307</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">20.21611393834443</span><span class="p">,</span> <span class="mf">33.537028184717805</span><span class="p">,</span> <span class="mf">3158.2852236533854</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">19.5918587709697</span><span class="p">,</span> <span class="mf">33.41346072098646</span><span class="p">,</span> <span class="mf">3266.394200342208</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">18.956867500260778</span><span class="p">,</span> <span class="mf">33.29207182665039</span><span class="p">,</span> <span class="mf">3373.980277975981</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">18.311011341359094</span><span class="p">,</span> <span class="mf">33.1727775516753</span><span class="p">,</span> <span class="mf">3480.9119570125376</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">17.65416914988038</span><span class="p">,</span> <span class="mf">33.05550042166596</span><span class="p">,</span> <span class="mf">3587.0496060803525</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">16.986229182513465</span><span class="p">,</span> <span class="mf">32.94016922267288</span><span class="p">,</span> <span class="mf">3692.2451906135816</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">16.307091077955235</span><span class="p">,</span> <span class="mf">32.82671882361354</span><span class="p">,</span> <span class="mf">3796.342039979603</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">15.616668070825733</span><span class="p">,</span> <span class="mf">32.715090033111295</span><span class="p">,</span> <span class="mf">3899.174664759246</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">14.914889448473955</span><span class="p">,</span> <span class="mf">32.605229487400294</span><span class="p">,</span> <span class="mf">4000.5686376735853</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">14.201703256592454</span><span class="p">,</span> <span class="mf">32.49708956568428</span><span class="p">,</span> <span class="mf">4100.340553530705</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">13.477079254053594</span><span class="p">,</span> <span class="mf">32.39062832896536</span><span class="p">,</span> <span class="mf">4198.298085460549</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">12.74101211011022</span><span class="p">,</span> <span class="mf">32.28580947787746</span><span class="p">,</span> <span class="mf">4294.2401564873835</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">11.993524827836492</span><span class="p">,</span> <span class="mf">32.182602324469904</span><span class="p">,</span> <span class="mf">4387.957247037305</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">11.234672366244187</span><span class="p">,</span> <span class="mf">32.08098177220725</span><span class="p">,</span> <span class="mf">4479.2318601212155</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">10.464545419812909</span><span class="p">,</span> <span class="mf">31.980928297701848</span><span class="p">,</span> <span class="mf">4567.839166459296</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">9.683274298285431</span><span class="p">,</span> <span class="mf">31.882427926917643</span><span class="p">,</span> <span class="mf">4653.5478514627275</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">8.891032831773657</span><span class="p">,</span> <span class="mf">31.785472197828597</span><span class="p">,</span> <span class="mf">4736.121184517072</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">8.088042207038903</span><span class="p">,</span> <span class="mf">31.69005810085546</span><span class="p">,</span> <span class="mf">4815.318328103372</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">7.274574621123668</span><span class="p">,</span> <span class="mf">31.596187987929785</span><span class="p">,</span> <span class="mf">4890.895899676693</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">6.450956619559903</span><span class="p">,</span> <span class="mf">31.5038694408466</span><span class="p">,</span> <span class="mf">4962.609792711119</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">5.617571969778859</span><span class="p">,</span> <span class="mf">31.41311508978187</span><span class="p">,</span> <span class="mf">5030.217254715954</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">4.774863908051139</span><span class="p">,</span> <span class="mf">31.323942373578678</span><span class="p">,</span> <span class="mf">5093.479209429139</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">3.9233365924680697</span><span class="p">,</span> <span class="mf">31.236373234746175</span><span class="p">,</span> <span class="mf">5152.162797945735</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">3.063555597347234</span><span class="p">,</span> <span class="mf">31.150433744133263</span><span class="p">,</span> <span class="mf">5206.044099754603</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">2.1961472979805383</span><span class="p">,</span> <span class="mf">31.06615365295016</span><span class="p">,</span> <span class="mf">5254.910980237076</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">1.321797020253233</span><span class="p">,</span> <span class="mf">30.983565873161062</span><span class="p">,</span> <span class="mf">5298.565997160113</span><span class="p">),</span>
    <span class="p">(</span><span class="o">-</span><span class="mf">0.44124586783960634</span><span class="p">,</span> <span class="mf">30.902705891123393</span><span class="p">,</span> <span class="mf">5336.829286243155</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">0.4447138103142732</span><span class="p">,</span> <span class="mf">30.823611123479452</span><span class="p">,</span> <span class="mf">5369.5413363602565</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">1.3352442898544556</span><span class="p">,</span> <span class="mf">30.7463202284137</span><span class="p">,</span> <span class="mf">5396.565559641328</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">2.2294695901886556</span><span class="p">,</span> <span class="mf">30.67087238911697</span><span class="p">,</span> <span class="mf">5417.790561738033</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">3.126483688099488</span><span class="p">,</span> <span class="mf">30.597306589277835</span><span class="p">,</span> <span class="mf">5433.132023508345</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">4.025359608621255</span><span class="p">,</span> <span class="mf">30.525660902311937</span><span class="p">,</span> <span class="mf">5442.534117529116</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">4.925159123944251</span><span class="p">,</span> <span class="mf">30.455971816588935</span><span class="p">,</span> <span class="mf">5445.970400588792</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">5.824942754416151</span><span class="p">,</span> <span class="mf">30.388273617996692</span><span class="p">,</span> <span class="mf">5443.44414558897</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">6.723779748080034</span><span class="p">,</span> <span class="mf">30.322597848819587</span><span class="p">,</span> <span class="mf">5434.988101322176</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">7.620757718372649</span><span class="p">,</span> <span class="mf">30.258972858287184</span><span class="p">,</span> <span class="mf">5420.663694434347</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">8.514991643138769</span><span class="p">,</span> <span class="mf">30.19742345558996</span><span class="p">,</span> <span class="mf">5400.559712377128</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">9.405631969406274</span><span class="p">,</span> <span class="mf">30.13797067107105</span><span class="p">,</span> <span class="mf">5374.790527381686</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">10.29187162310827</span><span class="p">,</span> <span class="mf">30.08063162613404</span><span class="p">,</span> <span class="mf">5343.493937973663</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">11.172951785773765</span><span class="p">,</span> <span class="mf">30.025419507579517</span><span class="p">,</span> <span class="mf">5306.828715291518</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">12.048166365473644</span><span class="p">,</span> <span class="mf">29.972343637946285</span><span class="p">,</span> <span class="mf">5264.971946305724</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">12.916865151755497</span><span class="p">,</span> <span class="mf">29.921409630229302</span><span class="p">,</span> <span class="mf">5218.11626510594</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">13.778455699650472</span><span class="p">,</span> <span class="mf">29.87261961319553</span><span class="p">,</span> <span class="mf">5166.4670576997105</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">14.6324040331183</span><span class="p">,</span> <span class="mf">29.82597251242545</span><span class="p">,</span> <span class="mf">5110.239716210898</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">15.478234291947636</span><span class="p">,</span> <span class="mf">29.781464372080617</span><span class="p">,</span> <span class="mf">5049.657006330503</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">16.315527467884976</span><span class="p">,</span> <span class="mf">29.73908870307601</span><span class="p">,</span> <span class="mf">4984.946598543721</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">17.143919386417263</span><span class="p">,</span> <span class="mf">29.698836844625532</span><span class="p">,</span> <span class="mf">4916.338800153438</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">17.963098091708947</span><span class="p">,</span> <span class="mf">29.660698327823923</span><span class="p">,</span> <span class="mf">4844.064512303638</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">18.77280078563276</span><span class="p">,</span> <span class="mf">29.624661231839266</span><span class="p">,</span> <span class="mf">4768.353424718179</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">19.572810459698225</span><span class="p">,</span> <span class="mf">29.59071252525364</span><span class="p">,</span> <span class="mf">4689.4324510854285</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">20.362952342940826</span><span class="p">,</span> <span class="mf">29.55883838697974</span><span class="p">,</span> <span class="mf">4607.524400112143</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">21.143090271212472</span><span class="p">,</span> <span class="mf">29.529024502908456</span><span class="p">,</span> <span class="mf">4522.846871214492</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">21.913123065211792</span><span class="p">,</span> <span class="mf">29.50125633595237</span><span class="p">,</span> <span class="mf">4435.6113595192655</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">22.67298098707163</span><span class="p">,</span> <span class="mf">29.475519368416595</span><span class="p">,</span> <span class="mf">4346.022552066801</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">23.422622329111146</span><span class="p">,</span> <span class="mf">29.451799316649225</span><span class="p">,</span> <span class="mf">4254.2777956161535</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">24.1620301739114</span><span class="p">,</span> <span class="mf">29.430082318710383</span><span class="p">,</span> <span class="mf">4160.5667160045305</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">24.891209352402193</span><span class="p">,</span> <span class="mf">29.410355096376488</span><span class="p">,</span> <span class="mf">4065.0709693314634</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">25.610183616198505</span><span class="p">,</span> <span class="mf">29.3926050931917</span><span class="p">,</span> <span class="mf">3967.9641061440957</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">26.31899303191521</span><span class="p">,</span> <span class="mf">29.376820590523245</span><span class="p">,</span> <span class="mf">3869.411531086794</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">27.0176915984609</span><span class="p">,</span> <span class="mf">29.362990803700338</span><span class="p">,</span> <span class="mf">3769.570541990718</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">27.70634508315988</span><span class="p">,</span> <span class="mf">29.351105960345272</span><span class="p">,</span> <span class="mf">3668.5904340019447</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">28.385029068755717</span><span class="p">,</span> <span class="mf">29.341157362963145</span><span class="p">,</span> <span class="mf">3566.6126560088856</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">29.05382720068859</span><span class="p">,</span> <span class="mf">29.333137437764957</span><span class="p">,</span> <span class="mf">3463.771008224052</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">29.712829622304703</span><span class="p">,</span> <span class="mf">29.327039771572494</span><span class="p">,</span> <span class="mf">3360.191871297074</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">30.362131584662148</span><span class="p">,</span> <span class="mf">29.322859138506708</span><span class="p">,</span> <span class="mf">3255.9944587413106</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">31.001832217179633</span><span class="p">,</span> <span class="mf">29.320591518003912</span><span class="p">,</span> <span class="mf">3151.291085728526</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">31.632033445393088</span><span class="p">,</span> <span class="mf">29.320234105543264</span><span class="p">,</span> <span class="mf">3046.1874484433674</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">32.25283904242543</span><span class="p">,</span> <span class="mf">29.32178531731026</span><span class="p">,</span> <span class="mf">2940.7829091901353</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">32.86435380134023</span><span class="p">,</span> <span class="mf">29.325244789867906</span><span class="p">,</span> <span class="mf">2835.1707833303</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">33.46668281626752</span><span class="p">,</span> <span class="mf">29.3306133757618</span><span class="p">,</span> <span class="mf">2729.438624871505</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">34.05993086099915</span><span class="p">,</span> <span class="mf">29.33789313584865</span><span class="p">,</span> <span class="mf">2623.6685081916003</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">34.644201854606706</span><span class="p">,</span> <span class="mf">29.34708732901021</span><span class="p">,</span> <span class="mf">2517.9373039172647</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">35.2195984045041</span><span class="p">,</span> <span class="mf">29.358200399795482</span><span class="p">,</span> <span class="mf">2412.31694745271</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">35.7862214182336</span><span class="p">,</span> <span class="mf">29.37123796442264</span><span class="p">,</span> <span class="mf">2306.874699029434</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">36.3441697760819</span><span class="p">,</span> <span class="mf">29.38620679546709</span><span class="p">,</span> <span class="mf">2201.673394479185</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">36.89354005741947</span><span class="p">,</span> <span class="mf">29.403114805461755</span><span class="p">,</span> <span class="mf">2096.771686189296</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">37.4344263143956</span><span class="p">,</span> <span class="mf">29.421971029538316</span><span class="p">,</span> <span class="mf">1992.224273917965</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">37.9669198873078</span><span class="p">,</span> <span class="mf">29.442785607141523</span><span class="p">,</span> <span class="mf">1888.0821253214035</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">38.491109256598534</span><span class="p">,</span> <span class="mf">29.465569762750437</span><span class="p">,</span> <span class="mf">1784.392686181506</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">39.00707992701201</span><span class="p">,</span> <span class="mf">29.490335785437964</span><span class="p">,</span> <span class="mf">1681.2000804353756</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">39.514914339973785</span><span class="p">,</span> <span class="mf">29.51709700699035</span><span class="p">,</span> <span class="mf">1578.5453001896585</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">40.01469181073535</span><span class="p">,</span> <span class="mf">29.54586777818758</span><span class="p">,</span> <span class="mf">1476.4663859706093</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">40.506488487260484</span><span class="p">,</span> <span class="mf">29.576663442710245</span><span class="p">,</span> <span class="mf">1374.9985975068655</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">40.99037732822065</span><span class="p">,</span> <span class="mf">29.609500307983723</span><span class="p">,</span> <span class="mf">1274.174575373318</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">41.46642809781705</span><span class="p">,</span> <span class="mf">29.64439561209029</span><span class="p">,</span> <span class="mf">1174.024493854608</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">41.93470737546064</span><span class="p">,</span> <span class="mf">29.681367485668204</span><span class="p">,</span> <span class="mf">1074.5762053888166</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">42.39527857861846</span><span class="p">,</span> <span class="mf">29.720434907465563</span><span class="p">,</span> <span class="mf">975.8553769697422</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">42.848201997380436</span><span class="p">,</span> <span class="mf">29.761617651915476</span><span class="p">,</span> <span class="mf">877.8856188725068</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">43.29353483951309</span><span class="p">,</span> <span class="mf">29.804936226737404</span><span class="p">,</span> <span class="mf">780.6886060763069</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">43.7313312849494</span><span class="p">,</span> <span class="mf">29.850411798131685</span><span class="p">,</span> <span class="mf">684.2841927326435</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">44.16164254881369</span><span class="p">,</span> <span class="mf">29.898066100603295</span><span class="p">,</span> <span class="mf">588.6905200287431</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">44.584516952199515</span><span class="p">,</span> <span class="mf">29.947921327804714</span><span class="p">,</span> <span class="mf">493.92411777134504</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">45.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">45.4271000089397</span><span class="p">,</span> <span class="mf">30.054327754522603</span><span class="p">,</span> <span class="mf">306.4446284174588</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">45.84643903260964</span><span class="p">,</span> <span class="mf">30.111032625022695</span><span class="p">,</span> <span class="mf">213.71898027239706</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">46.258063637179326</span><span class="p">,</span> <span class="mf">30.170141590417526</span><span class="p">,</span> <span class="mf">121.83824229187483</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">46.6620177206953</span><span class="p">,</span> <span class="mf">30.231681544777825</span><span class="p">,</span> <span class="mf">30.816138423313017</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">47.058342603855564</span><span class="p">,</span> <span class="mf">30.29567899837887</span><span class="p">,</span> <span class="o">-</span><span class="mf">59.33498391874138</span><span class="p">),</span>
<span class="p">]</span>


<div class="viewcode-block" id="TestFieldLineTracing"><a class="viewcode-back" href="../../../../api/eoxmagmod.magnetic_model.tests.html#eoxmagmod.magnetic_model.tests.field_lines.TestFieldLineTracing">[docs]</a><span class="k">class</span> <span class="nc">TestFieldLineTracing</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">decimal_year_to_mjd2000</span><span class="p">(</span><span class="mf">2015.5</span><span class="p">)</span>
    <span class="n">point</span> <span class="o">=</span> <span class="n">START_POINT</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">FIELD_LINE_POINTS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_model&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">load_model_shc</span><span class="p">(</span><span class="n">IGRF12</span><span class="p">,</span> <span class="n">interpolate_in_decimal_years</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

<div class="viewcode-block" id="TestFieldLineTracing.test_trace_field_line_wgs84"><a class="viewcode-back" href="../../../../api/eoxmagmod.magnetic_model.tests.html#eoxmagmod.magnetic_model.tests.field_lines.TestFieldLineTracing.test_trace_field_line_wgs84">[docs]</a>    <span class="k">def</span> <span class="nf">test_trace_field_line_wgs84</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">trace_field_line</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span>
        <span class="p">))</span></div>

<div class="viewcode-block" id="TestFieldLineTracing.test_trace_field_line_spherical"><a class="viewcode-back" href="../../../../api/eoxmagmod.magnetic_model.tests.html#eoxmagmod.magnetic_model.tests.field_lines.TestFieldLineTracing.test_trace_field_line_spherical">[docs]</a>    <span class="k">def</span> <span class="nf">test_trace_field_line_spherical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span> <span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">)</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">trace_field_line</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">convert</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span> <span class="n">GEOCENTRIC_SPHERICAL</span>
        <span class="p">))</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_SPHERICAL</span><span class="p">,</span>
        <span class="p">))</span></div>

<div class="viewcode-block" id="TestFieldLineTracing.test_trace_field_line_cartesian"><a class="viewcode-back" href="../../../../api/eoxmagmod.magnetic_model.tests.html#eoxmagmod.magnetic_model.tests.field_lines.TestFieldLineTracing.test_trace_field_line_cartesian">[docs]</a>    <span class="k">def</span> <span class="nf">test_trace_field_line_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span> <span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">)</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">trace_field_line</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">convert</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">GEODETIC_ABOVE_WGS84</span><span class="p">,</span> <span class="n">GEOCENTRIC_CARTESIAN</span>
        <span class="p">))</span>
        <span class="n">assert_allclose</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span>
            <span class="n">input_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">,</span>
            <span class="n">output_coordinate_system</span><span class="o">=</span><span class="n">GEOCENTRIC_CARTESIAN</span><span class="p">,</span>
        <span class="p">))</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, dolezalovat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>